{"pages":[{"title":"About","date":"2024-10-16T01:28:57.268Z","path":"about/index.html","text":"这是一个使用 Hexo + Wikittn + Github page + PicX 搭建的一个技术笔记。"},{"title":"Tags","date":"2024-10-12T09:25:41.287Z","path":"tags/index.html","text":""},{"title":"Categories","date":"2024-10-12T09:25:41.285Z","path":"categories/index.html","text":""}],"posts":[{"title":"Windows病毒分析三板斧-汇编","date":"2024-10-16T01:39:31.000Z","path":"wiki/Windows_Virus-analysis_Assembly/","text":"参考资料","tags":[{"name":"Windows","slug":"Windows","permalink":"http://example.com/tags/Windows/"},{"name":"Virus analysis","slug":"Virus-analysis","permalink":"http://example.com/tags/Virus-analysis/"}],"categories":[{"name":"恶意样本分析（Virus analysi）","slug":"恶意样本分析（Virus-analysi）","permalink":"http://example.com/categories/%E6%81%B6%E6%84%8F%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%EF%BC%88Virus-analysi%EF%BC%89/"}]},{"title":"PHP代码审计三板斧-Xss漏洞","date":"2024-10-16T01:38:11.000Z","path":"wiki/PHP-Code_Auditing-Xss_Vulnerability/","text":"参考资料","tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"Code auditing","slug":"Code-auditing","permalink":"http://example.com/tags/Code-auditing/"}],"categories":[{"name":"代码审计（Code auditing）","slug":"代码审计（Code-auditing）","permalink":"http://example.com/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%EF%BC%88Code-auditing%EF%BC%89/"}]},{"title":"PHP代码审计三板斧-Sql注入漏洞","date":"2024-10-16T01:36:37.000Z","path":"wiki/PHP-Code_Auditing-Sql_injection_Vulnerability/","text":"参考资料","tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"Code auditing","slug":"Code-auditing","permalink":"http://example.com/tags/Code-auditing/"}],"categories":[{"name":"代码审计（Code auditing）","slug":"代码审计（Code-auditing）","permalink":"http://example.com/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%EF%BC%88Code-auditing%EF%BC%89/"}]},{"title":"PHP代码审计三板斧-命令执行漏洞","date":"2024-10-12T14:26:28.000Z","path":"wiki/PHP-Code_Auditing-Command_Execution_Vulnerability/","text":"常见的命令执行函数 常见函数 参考 system() system()输出并返回最后一行shell结果。参考:https://www.php.net/manual/zh/function.system.php exec() 不输出结果，返回最后一行shell结果，所有结果可以保存到一个返回的数组里面。参考:https://www.php.net/manual/zh/function.exec.php passthru() 只调用命令，把命令的运行结果原样地直接输出到标准输出设备上。参考:https://www.php.net/manual/zh/function.passthru.php &#96;&#96; 参考:https://www.php.net/manual/zh/language.operators.execution.php shell_exec() 参考:https://www.php.net/manual/zh/function.shell-exec.php popen() 不会直接返回执行结果，而是返回一个文件指针。参考:https://www.php.net/manual/zh/function.popen.php proc_open() 不会直接返回执行结果，而是返回一个文件指针。参考:https://www.php.net/manual/zh/function.proc-open.php pcntl_exec() 参考:https://www.php.net/manual/zh/function.pcntl-exec.php mail() PHP-4.2.2以下到 PHP-4.0.5版本都存在 PHP mail 函数绕过 safe_mode 限制执行命令漏洞，4.0.5版本开始 mail 函数增加了第五个参数，由于设计者考虑不周可以突破 safe_mode 的 限制执行命令。其中4.0.5版本突破非常简单，只需用分号隔开后面加 shell 命令就可以了 常见的命令执行函数 常见函数 参考 escapeshellarg() escapeshellcmd() 案例1、system() 2、exec() 3、passthru() 4、&#96;&#96; 5、shell_exec() 6、popen()7、proc_open()8、pcntl_exec()9、mail()（1）古老的PHP mail 函数绕过 safe_mode 限制执行命令漏洞这个漏洞应该很古老了，我搭建好了可以发邮件的环境，但是没复现出来，应该是PHP版本的问题。PHP-4.2.2以下到 PHP-4.0.5版本都存在 PHP mail 函数绕过 safe_mode 限制执行命令漏洞，4.0.5版本开始 mail 函数增加了第五个参数，由于设计者考虑不周可以突破 safe_mode 的限制执行命令。其中4.0.5版本突破非常简单，只需用分号隔开后面加 shell 命令就可以了。","tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"Code auditing","slug":"Code-auditing","permalink":"http://example.com/tags/Code-auditing/"}],"categories":[{"name":"代码审计（Code auditing）","slug":"代码审计（Code-auditing）","permalink":"http://example.com/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%EF%BC%88Code-auditing%EF%BC%89/"}]}],"categories":[{"name":"恶意样本分析（Virus analysi）","slug":"恶意样本分析（Virus-analysi）","permalink":"http://example.com/categories/%E6%81%B6%E6%84%8F%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%EF%BC%88Virus-analysi%EF%BC%89/"},{"name":"代码审计（Code auditing）","slug":"代码审计（Code-auditing）","permalink":"http://example.com/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%EF%BC%88Code-auditing%EF%BC%89/"}],"tags":[{"name":"Windows","slug":"Windows","permalink":"http://example.com/tags/Windows/"},{"name":"Virus analysis","slug":"Virus-analysis","permalink":"http://example.com/tags/Virus-analysis/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"Code auditing","slug":"Code-auditing","permalink":"http://example.com/tags/Code-auditing/"}]}